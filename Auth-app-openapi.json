{"openapi":"3.1.0","info":{"title":"Auth API","version":"0.1.0"},"paths":{"/api/auth/login":{"post":{"tags":["Auth"],"summary":"Login","description":"Login endpoint with organization support.\n\nFlow:\n1. If no code → sends 2FA verification code to email\n2. If code + single org → auto-select org, returns tokens\n3. If code + multiple orgs (no org_id) → returns org list\n4. If code + org_id → returns org-scoped tokens\n\nReturns:\n- LoginCodeSentResponse: If verification code sent\n- OrganizationSelectionResponse: If user needs to select org\n- TokenResponse: If login successful with tokens","operationId":"login_api_auth_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/app__schemas__auth__TokenResponse"},{"$ref":"#/components/schemas/LoginCodeSentResponse"},{"$ref":"#/components/schemas/OrganizationSelectionResponse"}],"title":"Response Login Api Auth Login Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/login/2fa":{"post":{"tags":["Auth"],"summary":"Login 2Fa","operationId":"login_2fa_api_auth_login_2fa_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TwoFactorLoginRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/app__schemas__auth__TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/register":{"post":{"tags":["Auth"],"summary":"Register User","operationId":"register_user_api_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/logout":{"post":{"tags":["Auth"],"summary":"Logout","operationId":"logout_api_auth_logout_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/refresh":{"post":{"tags":["Auth"],"summary":"Refresh Token","operationId":"refresh_token_api_auth_refresh_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/app__schemas__auth__TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/verify-code":{"post":{"tags":["Auth"],"summary":"Verify Code","operationId":"verify_code_api_auth_verify_code_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyEmailRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/request-password-reset":{"post":{"tags":["Auth"],"summary":"Request Password Reset","operationId":"request_password_reset_api_auth_request_password_reset_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RequestPasswordResetRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/reset-password":{"post":{"tags":["Auth"],"summary":"Confirm Password Reset","operationId":"confirm_password_reset_api_auth_reset_password_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResetPasswordRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/2fa/setup":{"post":{"tags":["2FA"],"summary":"Setup 2Fa","operationId":"setup_2fa_api_auth_2fa_setup_post","parameters":[{"name":"authorization","in":"header","required":true,"schema":{"type":"string","title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/2fa/verify":{"post":{"tags":["2FA"],"summary":"Verify 2Fa Setup","operationId":"verify_2fa_setup_api_auth_2fa_verify_post","parameters":[{"name":"authorization","in":"header","required":true,"schema":{"type":"string","title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TwoFactorVerifyRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/2fa/disable":{"post":{"tags":["2FA"],"summary":"Disable 2Fa","operationId":"disable_2fa_api_auth_2fa_disable_post","parameters":[{"name":"authorization","in":"header","required":true,"schema":{"type":"string","title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/organizations":{"post":{"tags":["Organizations"],"summary":"Create Organization","description":"Create a new organization. Creator becomes owner automatically.","operationId":"create_organization_api_auth_organizations_post","parameters":[{"name":"Authorization","in":"header","required":true,"schema":{"type":"string","title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrganizationCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrganizationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Organizations"],"summary":"List User's Organizations","description":"Get all organizations the current user is a member of.","operationId":"list_user_organizations_api_auth_organizations_get","parameters":[{"name":"Authorization","in":"header","required":true,"schema":{"type":"string","title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/OrganizationMembershipResponse"},"title":"Response List User Organizations Api Auth Organizations Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/organizations/{org_id}":{"get":{"tags":["Organizations"],"summary":"Get Organization","description":"Get organization details by ID. Requires membership.","operationId":"get_organization_api_auth_organizations__org_id__get","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Org Id"}},{"name":"Authorization","in":"header","required":true,"schema":{"type":"string","title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrganizationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/organizations/{org_id}/members":{"get":{"tags":["Organizations"],"summary":"List Organization Members","description":"Get list of organization members with roles.","operationId":"list_organization_members_api_auth_organizations__org_id__members_get","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Org Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}},{"name":"Authorization","in":"header","required":true,"schema":{"type":"string","title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/OrganizationMemberResponse"},"title":"Response List Organization Members Api Auth Organizations  Org Id  Members Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Organizations"],"summary":"Add Organization Member","description":"Add a user to the organization. Requires admin or owner role.","operationId":"add_organization_member_api_auth_organizations__org_id__members_post","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Org Id"}},{"name":"Authorization","in":"header","required":true,"schema":{"type":"string","title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrganizationMemberAdd"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrganizationMemberResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/organizations/{org_id}/members/{member_user_id}":{"delete":{"tags":["Organizations"],"summary":"Remove Organization Member","description":"Remove a user from the organization. Requires admin or owner role.","operationId":"remove_organization_member_api_auth_organizations__org_id__members__member_user_id__delete","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Org Id"}},{"name":"member_user_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Member User Id"}},{"name":"Authorization","in":"header","required":true,"schema":{"type":"string","title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Remove Organization Member Api Auth Organizations  Org Id  Members  Member User Id  Delete"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/organizations/{org_id}/members/{member_user_id}/role":{"patch":{"tags":["Organizations"],"summary":"Update Member Role","description":"Change a member's role in the organization. Requires owner role.","operationId":"update_member_role_api_auth_organizations__org_id__members__member_user_id__role_patch","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Org Id"}},{"name":"member_user_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Member User Id"}},{"name":"Authorization","in":"header","required":true,"schema":{"type":"string","title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrganizationMemberUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Update Member Role Api Auth Organizations  Org Id  Members  Member User Id  Role Patch"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/organizations/{org_id}/groups":{"post":{"tags":["RBAC - Groups"],"summary":"Create Group","description":"Create a new group in organization (OAuth: groups:write)","operationId":"create_group_api_auth_organizations__org_id__groups_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Org Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GroupCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GroupResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["RBAC - Groups"],"summary":"List Groups","description":"List all groups in organization (OAuth: groups:read)","operationId":"list_organization_groups_api_auth_organizations__org_id__groups_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Org Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/GroupResponse"},"title":"Response List Organization Groups Api Auth Organizations  Org Id  Groups Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/groups/{group_id}":{"get":{"tags":["RBAC - Groups"],"summary":"Get Group","description":"Get group details (OAuth: groups:read)","operationId":"get_group_api_auth_groups__group_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Group Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GroupResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["RBAC - Groups"],"summary":"Update Group","description":"Update group details (OAuth: groups:write)","operationId":"update_group_api_auth_groups__group_id__patch","security":[{"HTTPBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Group Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GroupUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GroupResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["RBAC - Groups"],"summary":"Delete Group","description":"Delete group (OAuth: groups:write)","operationId":"delete_group_api_auth_groups__group_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Group Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/groups/{group_id}/members":{"post":{"tags":["RBAC - Groups"],"summary":"Add Member","description":"Add user to group (OAuth: members:write)","operationId":"add_group_member_api_auth_groups__group_id__members_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Group Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GroupMemberAdd"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GroupMemberResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["RBAC - Groups"],"summary":"List Members","description":"List group members (OAuth: members:read)","operationId":"list_group_members_api_auth_groups__group_id__members_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Group Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/GroupMemberResponse"},"title":"Response List Group Members Api Auth Groups  Group Id  Members Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/groups/{group_id}/members/{user_id}":{"delete":{"tags":["RBAC - Groups"],"summary":"Remove Member","description":"Remove user from group (OAuth: members:write)","operationId":"remove_group_member_api_auth_groups__group_id__members__user_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Group Id"}},{"name":"user_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"User Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/groups/{group_id}/permissions":{"post":{"tags":["RBAC - Groups"],"summary":"Grant Permission","description":"Grant permission to group (OAuth: permissions:write)","operationId":"grant_permission_to_group_api_auth_groups__group_id__permissions_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Group Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GroupPermissionGrant"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GroupPermissionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["RBAC - Groups"],"summary":"List Permissions","description":"List permissions granted to group (OAuth: permissions:read)","operationId":"list_group_permissions_api_auth_groups__group_id__permissions_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Group Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/GroupPermissionResponse"},"title":"Response List Group Permissions Api Auth Groups  Group Id  Permissions Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/groups/{group_id}/permissions/{permission_id}":{"delete":{"tags":["RBAC - Groups"],"summary":"Revoke Permission","description":"Revoke permission from group (OAuth: permissions:write)","operationId":"revoke_permission_from_group_api_auth_groups__group_id__permissions__permission_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Group Id"}},{"name":"permission_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Permission Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/permissions":{"get":{"tags":["RBAC - Groups"],"summary":"List Permissions","description":"List all available permissions (public, no auth required)","operationId":"list_permissions_api_auth_permissions_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/PermissionResponse"},"type":"array","title":"Response List Permissions Api Auth Permissions Get"}}}}}},"post":{"tags":["RBAC - Groups"],"summary":"Create Permission","description":"Create a new permission (OAuth: permissions:write)","operationId":"create_permission_api_auth_permissions_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermissionCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermissionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/auth/authorize":{"post":{"tags":["RBAC - Permissions"],"summary":"Authorize - THE CORE","description":"Check if user has permission in organization (Policy Decision Point)","operationId":"authorize_api_auth_authorize_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthorizationRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthorizationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/users/{user_id}/permissions":{"get":{"tags":["RBAC - Permissions"],"summary":"Get User Permissions","description":"List all permissions user has in organization","operationId":"get_user_permissions_api_auth_users__user_id__permissions_get","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"User Id"}},{"name":"organization_id","in":"query","required":true,"schema":{"type":"string","format":"uuid","description":"Organization ID","title":"Organization Id"},"description":"Organization ID"},{"name":"Authorization","in":"header","required":true,"schema":{"type":"string","title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserPermissionsResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/users/{user_id}/check-permission":{"get":{"tags":["RBAC - Permissions"],"summary":"Check Permission (GET)","description":"Quick permission check via GET request (convenience endpoint)","operationId":"check_permission_api_auth_users__user_id__check_permission_get","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"User Id"}},{"name":"organization_id","in":"query","required":true,"schema":{"type":"string","format":"uuid","description":"Organization ID","title":"Organization Id"},"description":"Organization ID"},{"name":"permission","in":"query","required":true,"schema":{"type":"string","pattern":"^[a-z_]+:[a-z_]+$","description":"Permission string (resource:action)","title":"Permission"},"description":"Permission string (resource:action)"},{"name":"Authorization","in":"header","required":true,"schema":{"type":"string","title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthorizationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/authorization/check":{"post":{"tags":["Authorization"],"summary":"Authorization Check (Image-API Compatible)","description":"Check if user has permission - compatible with image-api format","operationId":"check_authorization_api_v1_authorization_check_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ImageAPIAuthorizationRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ImageAPIAuthorizationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/dashboard/api":{"get":{"tags":["Dashboard","dashboard"],"summary":"Get comprehensive dashboard data (JSON)","description":"Get comprehensive technical dashboard data in JSON format.\n\nThis endpoint provides all monitoring data in a structured JSON format,\nsuitable for programmatic access by monitoring tools, scripts, and\nexternal systems. Data is collected in real-time with no caching.\n\n**Data Sections:**\n\n1. **System Health** - Database, Redis status, uptime\n   - Database connection status and basic stats\n   - Redis cache status and memory usage\n   - Service uptime since last restart\n   - Python version information\n\n2. **Database Metrics** - Detailed database statistics\n   - Connection pool utilization (active/idle/total)\n   - User statistics (total, verified, active, 24h activity)\n   - Token statistics (active, revoked, expired, 1h created)\n   - Recent user activity (last 10 users)\n   - Database table sizes\n\n3. **Prometheus Metrics** - All Prometheus counters and gauges\n   - HTTP request counts by endpoint and status\n   - Authentication operation counts (logins, registrations, etc.)\n   - Security metrics (rate limits, invalid credentials)\n   - Database query counts and connection stats\n   - Redis operation counts\n   - Business metrics (active users, sessions, 2FA enabled)\n\n4. **Configuration** - Safe settings (no secrets)\n   - Environment settings (debug, log level)\n   - Database connection config (host, pool sizes)\n   - Redis connection config\n   - JWT token expiration settings\n   - Rate limiting thresholds\n   - Email service configuration\n\n**Response Format:**\n```json\n{\n    \"timestamp\": \"2024-01-15T10:30:00.000000+00:00\",\n    \"system_health\": {\n        \"uptime_seconds\": 3600.5,\n        \"database\": {\"status\": \"healthy\", ...},\n        \"redis\": {\"status\": \"healthy\", ...}\n    },\n    \"database_metrics\": {\n        \"pool\": {...},\n        \"users\": {...},\n        \"tokens\": {...},\n        \"recent_users\": [...],\n        \"table_sizes\": [...]\n    },\n    \"prometheus_metrics\": {...},\n    \"configuration\": {...}\n}\n```\n\n**Performance:**\n- Response time: 50-200ms (depending on database size)\n- All data collected concurrently for optimal performance\n- Uses connection pooling for database and Redis\n\n**Use Cases:**\n- Integration with external monitoring (Datadog, New Relic, Grafana)\n- Custom alerting systems\n- CI/CD health checks\n- Load balancer health probes\n- Automated reporting scripts\n\n**Example Usage:**\n```bash\n# Get all data\ncurl http://localhost:8000/dashboard/api\n\n# Check if database is healthy\ncurl -s http://localhost:8000/dashboard/api | jq '.system_health.database.status'\n\n# Get total user count\ncurl -s http://localhost:8000/dashboard/api | jq '.database_metrics.users.total_users'\n\n# Monitor pool utilization\ncurl -s http://localhost:8000/dashboard/api | jq '.database_metrics.pool'\n```\n\n**Security Warning:**\n⚠️ This endpoint exposes operational data including user emails and system\nconfiguration. In production, protect this endpoint with authentication!\n\nReturns:\n    Dict: Comprehensive dashboard data with all metrics and statistics\n\nRaises:\n    HTTPException: 500 if critical data collection fails","operationId":"get_dashboard_data_dashboard_api_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/dashboard":{"get":{"tags":["Dashboard","dashboard"],"summary":"Dashboard UI","description":"Serve interactive HTML dashboard with real-time monitoring.\n\nThis endpoint serves a fully self-contained HTML page with embedded CSS and JavaScript\nthat provides a real-time monitoring interface for the authentication API. The dashboard\nauto-refreshes every 10 seconds to display the latest system metrics.\n\n**Dashboard Sections:**\n\n1. **System Health Card**\n   - Service uptime (days, hours, minutes)\n   - Database connection status (healthy/unhealthy)\n   - Redis cache status (healthy/unhealthy)\n   - Timestamp of current data\n\n2. **Database Status Card**\n   - Host and database name\n   - Database size (human-readable)\n   - Total users count\n   - Total tokens count\n\n3. **Redis Cache Card**\n   - Host and port\n   - Keys count\n   - Memory usage\n   - Connected clients\n   - Redis uptime\n\n4. **Connection Pool Card**\n   - Active/idle/total connections\n   - Pool utilization percentage\n   - Min/max pool size\n   - Color-coded utilization (green < 50%, yellow < 80%, red >= 80%)\n\n5. **User Statistics Card**\n   - Total users\n   - Verified/unverified users\n   - Active/inactive users\n   - New users (24h)\n   - Recent logins (24h)\n\n6. **Token Statistics Card**\n   - Total/active/revoked tokens\n   - Valid/expired tokens\n   - Tokens created (1h)\n\n7. **Authentication Metrics Card**\n   - Login attempts count\n   - Registrations count\n   - Email verifications count\n   - Password resets count\n   - 2FA operations count\n   - Token operations count\n\n8. **Security Metrics Card**\n   - Rate limit hits (color-coded warning)\n   - Invalid credentials attempts (color-coded by severity)\n   - Password validation failures\n\n9. **Configuration Card**\n   - Debug mode status (warning if enabled)\n   - Log level\n   - JWT algorithm and token TTLs\n   - 2FA enabled status\n\n10. **Recent User Activity Table**\n    - Last 10 users created\n    - Email addresses\n    - Verification status\n    - Created timestamp\n    - Last login timestamp\n\n11. **Database Table Sizes Card**\n    - Size of each table in human-readable format\n\n**UI Features:**\n\n- **Dark Theme**: Optimized for long monitoring sessions with reduced eye strain\n- **Monospace Font**: Technical data displayed in Monaco/Courier New for readability\n- **Color Coding**: Status indicators in green (healthy/good), yellow (warning), red (error)\n- **Auto-refresh**: Data updates every 10 seconds automatically\n- **Responsive Grid**: Cards organized in responsive grid layout\n- **Real-time Clock**: Shows last update time\n- **Error Handling**: Displays user-friendly error messages if data fetch fails\n- **Loading State**: Shows spinner during initial data load\n\n**Technical Details:**\n\n- Single-page application (SPA) with vanilla JavaScript\n- No external dependencies (self-contained)\n- Fetches data from /dashboard/api endpoint\n- Uses Fetch API for AJAX requests\n- CSS Grid for responsive layout\n- Handles partial failures gracefully\n\n**Auto-refresh Behavior:**\n\n- Initial load on page open\n- Refresh every 10 seconds via setInterval\n- Updates \"Last updated\" timestamp on each refresh\n- Preserves refresh interval on navigation\n- Shows error banner if fetch fails\n\n**Browser Compatibility:**\n\n- Modern browsers with ES6 support\n- Chrome 51+, Firefox 54+, Safari 10+, Edge 15+\n- Requires JavaScript enabled\n- Responsive design for desktop and tablet (not optimized for mobile)\n\n**Access:**\n\nOpen in browser: http://localhost:8000/dashboard\n\n**Security Warning:**\n\n⚠️ This dashboard displays sensitive operational data including:\n- User email addresses (last 10 recent users)\n- Database structure and sizes\n- System configuration details\n- Connection pool statistics\n\nIn production environments:\n- Add authentication middleware (API key, OAuth, etc.)\n- Restrict to admin users only\n- Use IP whitelist for internal access\n- Consider VPN-only access\n- Monitor access logs\n\n**Use Cases:**\n\n- Real-time system monitoring during normal operations\n- Troubleshooting during incidents (connection pool exhaustion, etc.)\n- Performance monitoring (query counts, response times)\n- Security monitoring (rate limit hits, invalid credentials)\n- Capacity planning (user growth, database size trends)\n\nReturns:\n    HTMLResponse: Self-contained HTML page with embedded CSS/JavaScript\n\nExample:\n    ```python\n    # Access in browser\n    http://localhost:8000/dashboard\n\n    # The page will auto-refresh every 10 seconds\n    # All metrics update in real-time\n    ```","operationId":"get_dashboard_html_dashboard_get","responses":{"200":{"description":"Successful Response","content":{"text/html":{"schema":{"type":"string"}}}}}}},"/oauth/authorize":{"get":{"tags":["OAuth 2.0","OAuth 2.0"],"summary":"Authorize Get","description":"OAuth 2.0 Authorization Endpoint (GET).\n\nFlow:\n1. Validate OAuth parameters\n2. Validate client and redirect_uri\n3. Check if user is logged in (session/token)\n4. Check consent status\n5. If consent needed: Show consent screen\n6. If consent given: Generate authorization code\n7. Redirect to redirect_uri with code\n\nSecurity:\n- PKCE challenge validation\n- Redirect URI exact matching\n- State parameter for CSRF protection","operationId":"authorize_get_oauth_authorize_get","parameters":[{"name":"response_type","in":"query","required":true,"schema":{"type":"string","description":"Response type (must be 'code')","title":"Response Type"},"description":"Response type (must be 'code')"},{"name":"client_id","in":"query","required":true,"schema":{"type":"string","description":"Client identifier","title":"Client Id"},"description":"Client identifier"},{"name":"redirect_uri","in":"query","required":true,"schema":{"type":"string","description":"Redirect URI","title":"Redirect Uri"},"description":"Redirect URI"},{"name":"scope","in":"query","required":true,"schema":{"type":"string","description":"Space-separated scopes","title":"Scope"},"description":"Space-separated scopes"},{"name":"state","in":"query","required":true,"schema":{"type":"string","description":"CSRF token","title":"State"},"description":"CSRF token"},{"name":"code_challenge","in":"query","required":true,"schema":{"type":"string","description":"SHA256(code_verifier)","title":"Code Challenge"},"description":"SHA256(code_verifier)"},{"name":"code_challenge_method","in":"query","required":false,"schema":{"type":"string","description":"PKCE method","default":"S256","title":"Code Challenge Method"},"description":"PKCE method"},{"name":"nonce","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"OpenID Connect nonce","title":"Nonce"},"description":"OpenID Connect nonce"}],"responses":{"200":{"description":"Successful Response","content":{"text/html":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["OAuth 2.0","OAuth 2.0"],"summary":"Authorize Post","description":"OAuth 2.0 Authorization Endpoint (POST) - Consent submission.\n\nHandles user consent decision (approve or deny).","operationId":"authorize_post_oauth_authorize_post","requestBody":{"required":true,"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_authorize_post_oauth_authorize_post"}}}},"responses":{"200":{"description":"Successful Response","content":{"text/html":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/oauth/token":{"post":{"tags":["OAuth 2.0","OAuth 2.0"],"summary":"Token Endpoint","description":"OAuth 2.0 Token Endpoint.\n\nSupports three grant types:\n1. authorization_code: Exchange authorization code for tokens (with PKCE validation)\n2. refresh_token: Refresh access token using refresh token\n3. client_credentials: Machine-to-machine authentication (service accounts)\n\nSecurity:\n- Client authentication (public: PKCE only, confidential: client_secret + PKCE)\n- PKCE validation (prevents code interception)\n- Single-use authorization codes\n- Token rotation (refresh tokens)\n- Scope validation (client_credentials limited to allowed_scopes)\n\nReturns:\n    TokenResponse with access_token, refresh_token (except client_credentials), expires_in, scope","operationId":"token_endpoint_oauth_token_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_token_endpoint_oauth_token_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/app__schemas__oauth__TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/oauth/revoke":{"post":{"tags":["OAuth 2.0","OAuth 2.0"],"summary":"Revoke Token","description":"OAuth 2.0 Token Revocation Endpoint (RFC 7009).\n\nRevokes access or refresh tokens. Per OAuth spec, this endpoint ALWAYS\nreturns 200 OK, even if the token doesn't exist or is already revoked\n(prevents token enumeration attacks).\n\nSecurity:\n- Client authentication required\n- Always returns 200 OK (no information leakage)\n- Validates token belongs to client\n\nArgs:\n    token: Token to revoke\n    token_type_hint: Optional hint (access_token or refresh_token)\n    client_id: Client identifier\n    client_secret: Client secret (for confidential clients)\n\nReturns:\n    200 OK (always)","operationId":"revoke_token_oauth_revoke_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_revoke_token_oauth_revoke_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/.well-known/oauth-authorization-server":{"get":{"tags":["OAuth 2.0 Discovery","OAuth 2.0 Discovery"],"summary":"OAuth 2.0 Authorization Server Metadata","description":"RFC 8414: OAuth 2.0 Authorization Server Metadata","operationId":"oauth_discovery__well_known_oauth_authorization_server_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OAuthDiscoveryResponse"}}}}}}},"/health":{"get":{"tags":["Health"],"summary":"Health Check","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/health":{"get":{"tags":["Health"],"summary":"Api Health Check","description":"Legacy health endpoint for backward compatibility","operationId":"api_health_check_api_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"AuthorizationRequest":{"properties":{"user_id":{"type":"string","format":"uuid","title":"User Id"},"organization_id":{"type":"string","format":"uuid","title":"Organization Id"},"permission":{"type":"string","pattern":"^[a-z_]+:[a-z_]+$","title":"Permission","description":"Permission string (resource:action)"},"resource_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Resource Id","description":"Optional specific resource ID"}},"type":"object","required":["user_id","organization_id","permission"],"title":"AuthorizationRequest","description":"Request schema for authorization check.","example":{"organization_id":"660e8400-e29b-41d4-a716-446655440001","permission":"activity:update","resource_id":"770e8400-e29b-41d4-a716-446655440002","user_id":"550e8400-e29b-41d4-a716-446655440000"}},"AuthorizationResponse":{"properties":{"authorized":{"type":"boolean","title":"Authorized"},"reason":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Reason"},"matched_groups":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Matched Groups"}},"type":"object","required":["authorized"],"title":"AuthorizationResponse","description":"Response schema for authorization check.","example":{"authorized":true,"matched_groups":["Admins","Content Creators"],"reason":"User has permission via group membership"}},"Body_authorize_post_oauth_authorize_post":{"properties":{"action":{"type":"string","title":"Action","description":"User action (approve or deny)"},"client_id":{"type":"string","title":"Client Id"},"redirect_uri":{"type":"string","title":"Redirect Uri"},"scope":{"type":"string","title":"Scope"},"code_challenge":{"type":"string","title":"Code Challenge"},"code_challenge_method":{"type":"string","title":"Code Challenge Method"},"state":{"type":"string","title":"State"},"nonce":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Nonce"},"org_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Org Id"}},"type":"object","required":["action","client_id","redirect_uri","scope","code_challenge","code_challenge_method","state"],"title":"Body_authorize_post_oauth_authorize_post"},"Body_revoke_token_oauth_revoke_post":{"properties":{"token":{"type":"string","title":"Token","description":"Token to revoke"},"token_type_hint":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Token Type Hint","description":"Token type hint (access_token or refresh_token)"},"client_id":{"type":"string","title":"Client Id","description":"Client identifier"},"client_secret":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Secret","description":"Client secret (for confidential clients)"}},"type":"object","required":["token","client_id"],"title":"Body_revoke_token_oauth_revoke_post"},"Body_token_endpoint_oauth_token_post":{"properties":{"grant_type":{"type":"string","title":"Grant Type","description":"Grant type (authorization_code or refresh_token)"},"code":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Code","description":"Authorization code"},"redirect_uri":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Redirect Uri","description":"Redirect URI (must match authorization request)"},"code_verifier":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Code Verifier","description":"PKCE code verifier"},"refresh_token":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Refresh Token","description":"Refresh token"},"client_id":{"type":"string","title":"Client Id","description":"Client identifier"},"client_secret":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Secret","description":"Client secret (for confidential clients)"},"scope":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Scope","description":"Requested scopes (for downscoping during refresh)"}},"type":"object","required":["grant_type","client_id"],"title":"Body_token_endpoint_oauth_token_post"},"GroupCreate":{"properties":{"name":{"type":"string","maxLength":100,"minLength":1,"title":"Name"},"description":{"anyOf":[{"type":"string","maxLength":1000},{"type":"null"}],"title":"Description"}},"type":"object","required":["name"],"title":"GroupCreate","description":"Request schema for creating a group.","example":{"description":"Users who can create and publish activities","name":"Content Creators"}},"GroupMemberAdd":{"properties":{"user_id":{"type":"string","format":"uuid","title":"User Id"}},"type":"object","required":["user_id"],"title":"GroupMemberAdd","description":"Request schema for adding member to group.","example":{"user_id":"550e8400-e29b-41d4-a716-446655440000"}},"GroupMemberResponse":{"properties":{"user_id":{"type":"string","format":"uuid","title":"User Id"},"email":{"type":"string","title":"Email"},"added_at":{"type":"string","format":"date-time","title":"Added At"},"added_by":{"type":"string","format":"uuid","title":"Added By"}},"type":"object","required":["user_id","email","added_at","added_by"],"title":"GroupMemberResponse","description":"Response schema for group member."},"GroupPermissionGrant":{"properties":{"permission_id":{"type":"string","format":"uuid","title":"Permission Id"}},"type":"object","required":["permission_id"],"title":"GroupPermissionGrant","description":"Request schema for granting permission to group.","example":{"permission_id":"550e8400-e29b-41d4-a716-446655440000"}},"GroupPermissionResponse":{"properties":{"permission_id":{"type":"string","format":"uuid","title":"Permission Id"},"resource":{"type":"string","title":"Resource"},"action":{"type":"string","title":"Action"},"permission_string":{"type":"string","title":"Permission String"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"granted_at":{"type":"string","format":"date-time","title":"Granted At"},"granted_by":{"type":"string","format":"uuid","title":"Granted By"}},"type":"object","required":["permission_id","resource","action","permission_string","granted_at","granted_by"],"title":"GroupPermissionResponse","description":"Response schema for group permission."},"GroupResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"organization_id":{"type":"string","format":"uuid","title":"Organization Id"},"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"member_count":{"type":"integer","title":"Member Count","default":0},"created_by":{"type":"string","format":"uuid","title":"Created By"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Updated At"}},"type":"object","required":["id","organization_id","name","created_by","created_at"],"title":"GroupResponse","description":"Response schema for group data."},"GroupUpdate":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":100,"minLength":1},{"type":"null"}],"title":"Name"},"description":{"anyOf":[{"type":"string","maxLength":1000},{"type":"null"}],"title":"Description"}},"type":"object","title":"GroupUpdate","description":"Request schema for updating a group."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"ImageAPIAuthorizationRequest":{"properties":{"org_id":{"type":"string","title":"Org Id"},"user_id":{"type":"string","title":"User Id"},"permission":{"type":"string","title":"Permission"}},"type":"object","required":["org_id","user_id","permission"],"title":"ImageAPIAuthorizationRequest","description":"Authorization request in image-api format."},"ImageAPIAuthorizationResponse":{"properties":{"allowed":{"type":"boolean","title":"Allowed"},"groups":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Groups"},"reason":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Reason"}},"type":"object","required":["allowed"],"title":"ImageAPIAuthorizationResponse","description":"Authorization response in image-api format."},"LoginCodeSentResponse":{"properties":{"message":{"type":"string","title":"Message"},"email":{"type":"string","title":"Email"},"user_id":{"type":"string","title":"User Id"},"expires_in":{"type":"integer","title":"Expires In","default":600},"requires_code":{"type":"boolean","title":"Requires Code","default":true}},"type":"object","required":["message","email","user_id"],"title":"LoginCodeSentResponse"},"LoginRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"User's email address"},"password":{"type":"string","title":"Password"},"code":{"anyOf":[{"type":"string","maxLength":6,"minLength":6},{"type":"null"}],"title":"Code","description":"Optional 6-digit login verification code"},"org_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Org Id","description":"Optional organization ID for org-scoped token"}},"type":"object","required":["email","password"],"title":"LoginRequest"},"OAuthDiscoveryResponse":{"properties":{"issuer":{"type":"string","title":"Issuer","description":"Authorization server identifier"},"authorization_endpoint":{"type":"string","title":"Authorization Endpoint","description":"Authorization endpoint URL"},"token_endpoint":{"type":"string","title":"Token Endpoint","description":"Token endpoint URL"},"revocation_endpoint":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Revocation Endpoint","description":"Token revocation endpoint URL"},"introspection_endpoint":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Introspection Endpoint","description":"Token introspection endpoint URL"},"response_types_supported":{"items":{"type":"string"},"type":"array","title":"Response Types Supported","description":"Supported response types"},"grant_types_supported":{"items":{"type":"string"},"type":"array","title":"Grant Types Supported","description":"Supported grant types"},"token_endpoint_auth_methods_supported":{"items":{"type":"string"},"type":"array","title":"Token Endpoint Auth Methods Supported","description":"Supported client auth methods"},"scopes_supported":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Scopes Supported","description":"Available scopes"},"code_challenge_methods_supported":{"items":{"type":"string"},"type":"array","title":"Code Challenge Methods Supported","description":"Supported PKCE methods"},"service_documentation":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Service Documentation","description":"Documentation URL"}},"type":"object","required":["issuer","authorization_endpoint","token_endpoint","response_types_supported","grant_types_supported","token_endpoint_auth_methods_supported","code_challenge_methods_supported"],"title":"OAuthDiscoveryResponse","description":"OAuth 2.0 Authorization Server Metadata (RFC 8414)"},"OrganizationCreate":{"properties":{"name":{"type":"string","maxLength":255,"minLength":1,"title":"Name","description":"Organization name"},"slug":{"type":"string","maxLength":50,"minLength":2,"pattern":"^[a-z0-9-]+$","title":"Slug","description":"URL-friendly identifier (lowercase, hyphens allowed)"},"description":{"anyOf":[{"type":"string","maxLength":1000},{"type":"null"}],"title":"Description","description":"Organization description"}},"type":"object","required":["name","slug"],"title":"OrganizationCreate","description":"Request schema for creating an organization.","examples":[{"description":"Leading provider of innovative solutions","name":"Acme Corporation","slug":"acme-corp"}]},"OrganizationMemberAdd":{"properties":{"user_id":{"type":"string","format":"uuid","title":"User Id","description":"User ID to add"},"role":{"type":"string","pattern":"^(owner|admin|member)$","title":"Role","description":"Member role","default":"member"}},"type":"object","required":["user_id"],"title":"OrganizationMemberAdd","description":"Request schema for adding a member to organization.","examples":[{"role":"member","user_id":"550e8400-e29b-41d4-a716-446655440000"}]},"OrganizationMemberResponse":{"properties":{"user_id":{"type":"string","format":"uuid","title":"User Id"},"email":{"type":"string","title":"Email"},"role":{"type":"string","title":"Role"},"joined_at":{"type":"string","format":"date-time","title":"Joined At"},"invited_by_email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Invited By Email"}},"type":"object","required":["user_id","email","role","joined_at"],"title":"OrganizationMemberResponse","description":"Response schema for organization member data."},"OrganizationMemberUpdate":{"properties":{"role":{"type":"string","pattern":"^(owner|admin|member)$","title":"Role","description":"New role"}},"type":"object","required":["role"],"title":"OrganizationMemberUpdate","description":"Request schema for updating member role."},"OrganizationMembershipResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"name":{"type":"string","title":"Name"},"slug":{"type":"string","title":"Slug"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"role":{"type":"string","title":"Role"},"member_count":{"type":"integer","title":"Member Count"},"joined_at":{"type":"string","format":"date-time","title":"Joined At"}},"type":"object","required":["id","name","slug","role","member_count","joined_at"],"title":"OrganizationMembershipResponse","description":"Response schema for user's organization membership."},"OrganizationOption":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"name":{"type":"string","title":"Name"},"slug":{"type":"string","title":"Slug"},"role":{"type":"string","title":"Role"},"member_count":{"type":"integer","title":"Member Count"}},"type":"object","required":["id","name","slug","role","member_count"],"title":"OrganizationOption","description":"Organization option for selection during login."},"OrganizationResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"name":{"type":"string","title":"Name"},"slug":{"type":"string","title":"Slug"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Updated At"},"member_count":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Member Count"}},"type":"object","required":["id","name","slug","created_at"],"title":"OrganizationResponse","description":"Response schema for organization data.","examples":[{"created_at":"2024-01-15T10:30:00Z","description":"Leading provider of innovative solutions","id":"550e8400-e29b-41d4-a716-446655440000","member_count":5,"name":"Acme Corporation","slug":"acme-corp","updated_at":"2024-01-15T10:30:00Z"}]},"OrganizationSelectionResponse":{"properties":{"message":{"type":"string","title":"Message"},"organizations":{"items":{"$ref":"#/components/schemas/OrganizationOption"},"type":"array","title":"Organizations"},"user_token":{"type":"string","title":"User Token","description":"User-level token for selecting organization"},"expires_in":{"type":"integer","title":"Expires In","default":900}},"type":"object","required":["message","organizations","user_token"],"title":"OrganizationSelectionResponse","description":"Response when user needs to select an organization."},"PermissionCreate":{"properties":{"resource":{"type":"string","maxLength":50,"minLength":1,"pattern":"^[a-z_]+$","title":"Resource","description":"Resource name (lowercase, underscores)"},"action":{"type":"string","maxLength":50,"minLength":1,"pattern":"^[a-z_]+$","title":"Action","description":"Action name (lowercase, underscores)"},"description":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Description"}},"type":"object","required":["resource","action"],"title":"PermissionCreate","description":"Request schema for creating a permission.","example":{"action":"create","description":"Create new activities","resource":"activity"}},"PermissionResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"resource":{"type":"string","title":"Resource"},"action":{"type":"string","title":"Action"},"permission_string":{"type":"string","title":"Permission String"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"created_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Created At"}},"type":"object","required":["id","resource","action","permission_string"],"title":"PermissionResponse","description":"Response schema for permission data.","example":{"action":"create","description":"Create new activities","id":"550e8400-e29b-41d4-a716-446655440000","permission_string":"activity:create","resource":"activity"}},"RefreshTokenRequest":{"properties":{"refresh_token":{"type":"string","title":"Refresh Token"}},"type":"object","required":["refresh_token"],"title":"RefreshTokenRequest"},"RequestPasswordResetRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email"}},"type":"object","required":["email"],"title":"RequestPasswordResetRequest"},"ResetPasswordRequest":{"properties":{"reset_token":{"type":"string","minLength":32,"title":"Reset Token","description":"Opaque reset token from email"},"code":{"type":"string","maxLength":6,"minLength":6,"title":"Code","description":"6-digit password reset code"},"new_password":{"type":"string","maxLength":128,"minLength":8,"title":"New Password","description":"New password (minimum 8 characters, strength validated in service layer)"}},"type":"object","required":["reset_token","code","new_password"],"title":"ResetPasswordRequest"},"TokenType":{"type":"string","enum":["bearer"],"title":"TokenType","description":"OAuth token types"},"TwoFactorLoginRequest":{"properties":{"pre_auth_token":{"type":"string","minLength":1,"title":"Pre Auth Token","description":"Pre-authentication token received from initial login"},"code":{"type":"string","maxLength":6,"minLength":6,"title":"Code","description":"6-digit TOTP code"}},"type":"object","required":["pre_auth_token","code"],"title":"TwoFactorLoginRequest"},"TwoFactorVerifyRequest":{"properties":{"code":{"type":"string","maxLength":6,"minLength":6,"title":"Code","description":"6-digit TOTP code"}},"type":"object","required":["code"],"title":"TwoFactorVerifyRequest"},"UserCreate":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","maxLength":100,"minLength":8,"title":"Password","description":"Password must be at least 8 characters"}},"type":"object","required":["email","password"],"title":"UserCreate"},"UserPermissionsResponse":{"properties":{"permissions":{"items":{"type":"string"},"type":"array","title":"Permissions"},"details":{"anyOf":[{"items":{"additionalProperties":true,"type":"object"},"type":"array"},{"type":"null"}],"title":"Details"}},"type":"object","required":["permissions"],"title":"UserPermissionsResponse","description":"Response schema for user's permissions list.","example":{"details":[{"permission":"activity:create","via_group":"Content Creators","via_group_id":"550e8400-e29b-41d4-a716-446655440000"}],"permissions":["activity:create","activity:read","activity:update"]}},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"VerifyEmailRequest":{"properties":{"verification_token":{"type":"string","minLength":32,"title":"Verification Token","description":"Opaque verification token from email"},"code":{"type":"string","maxLength":6,"minLength":6,"title":"Code","description":"6-digit verification code"}},"type":"object","required":["verification_token","code"],"title":"VerifyEmailRequest"},"app__schemas__auth__TokenResponse":{"properties":{"access_token":{"type":"string","title":"Access Token"},"refresh_token":{"type":"string","title":"Refresh Token"},"token_type":{"type":"string","title":"Token Type","default":"bearer"},"org_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Org Id","description":"Organization ID if org-scoped token"}},"type":"object","required":["access_token","refresh_token"],"title":"TokenResponse"},"app__schemas__oauth__TokenResponse":{"properties":{"access_token":{"type":"string","title":"Access Token","description":"Access token (JWT)"},"token_type":{"$ref":"#/components/schemas/TokenType","description":"Token type (always 'bearer')","default":"bearer"},"expires_in":{"type":"integer","title":"Expires In","description":"Access token lifetime in seconds"},"refresh_token":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Refresh Token","description":"Refresh token (if requested)"},"scope":{"type":"string","title":"Scope","description":"Granted scopes (space-separated)"},"org_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Org Id","description":"Organization ID (if org-scoped token)"}},"type":"object","required":["access_token","expires_in","scope"],"title":"TokenResponse","description":"OAuth token response (successful)"}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}}}